// Feistel Encryption
@2
D=M
@255
D=D&A
@10
M=D
@2
D=M
@24576
D=A
D=D+A
@16128
D=D+A
@2
D=D&M
@11
M=D
//RIGHT SHIFT FOR L0 SECTION BEGINS HERE
@11
D=M
@12
M=D
@144//JUMP TO DEAL WITH 2's COMPLIMENT
D;JLT
@16384
D=A
@12
M=M-D
D=M
@102
D;JLT
@64
D=A
@15
M=M+D
@8192
D=A
@12
M=M-D
D=M
@108
D;JLT
@32
D=A
@15
M=M+D
@4096
D=A
@12
M=M-D
D=M
@114
D;JLT
@16
D=A
@15
M=M+D
@2048
D=A
@12
M=M-D
D=M
@120
D;JLT
@8
D=A
@15
M=M+D
@1024
D=A
@12
M=M-D
D=M
@126
D;JLT
@4
D=A
@15
M=M+D
@512
D=A
@12
M=M-D
D=M
@132
D;JLT
@2
D=A
@15
M=M+D
@256
D=A
@12
M=M-D
D=M
@138
D;JLT
@1
D=A
@15
M=M+D
@156
0;JMP
@16384//JUMP TO ADD BACK 16384
D=A
@12
M=M+D
@34
0;JMP
@8192//JUMP TO ADD BACK 8192
D=A
@12
M=M+D
@45
0;JMP
@4096//JUMP TO ADD BACK 4096
D=A
@12
M=M+D
@56
0;JMP
@2048//JUMP TO ADD BACK 2048
D=A
@12
M=M+D
@67
0;JMP
@1024//JUMP TO ADD BACK 1024
D=A
@12
M=M+D
@78
0;JMP
@512//JUMP TO ADD BACK 512
D=A
@12
M=M+D
@89
0;JMP
@256//JUMP TO ADD BACK 256
D=A
@12
M=M+D
@100
0;JMP
@24576//DEAL WITH 2's COMPLIMENT
D=A
@8192
D=D+A
@12
M=M-D
@128
D=A
@15
M=M+D
@23
0;JMP
@15//START OF ENCRYPTION SECTION
D=M//11 = L0, 10 = R0
@11
M=D
@10
D=M
@12
M=D//12 = L1
@1//K0
D=!M
@10
D=D&M
@30
M=D
@10
D=!M
@1
D=D&M
@30
D=D|M
@13
M=D//13 = F(R0,K0)
@13
D=!M
@11
D=D&M
@30
M=D
@11
D=!M
@13
D=D&M
@30
D=D|M
@14
M=D//14 = R1 = L2
@1//SECTION TO SHIFT KEY
D=M
D=D+M
@256
D=D-A
@201
D;JGE
@204
0;JMP
D=D+1
@206
0;JMP
@256
D=D+A
@1
M=D//K1 NOW IN RAM[1]
@1//K1
D=!M
@14
D=D&M
@30
M=D
@14
D=!M
@1
D=D&M
@30
D=D|M
@15
M=D//15 = F(R1,K1)
@15
D=!M
@12
D=D&M
@30
M=D
@12
D=!M
@15
D=D&M
@30
D=D|M
@16
M=D//16 = R2 = L3
@1//SECTION TO SHIFT KEY
D=M
D=D+M
@256
D=D-A
@245
D;JGE
@248
0;JMP
D=D+1
@250
0;JMP
@256
D=D+A
@1
M=D//K2 NOW IN RAM[1]
@1//K2
D=!M
@16
D=D&M
@30
M=D
@16
D=!M
@1
D=D&M
@30
D=D|M
@17
M=D//17 = F(R2,K2)
@17
D=!M
@14
D=D&M
@30
M=D
@14
D=!M
@17
D=D&M
@30
D=D|M
@18
M=D//18 = R3 = L4
@1//SECTION TO SHIFT KEY
D=M
D=D+M
@256
D=D-A
@289
D;JGE
@292
0;JMP
D=D+1
@294
0;JMP
@256
D=D+A
@1
M=D//K3 NOW IN RAM[1]
@1//K3
D=!M
@18
D=D&M
@30
M=D
@18
D=!M
@1
D=D&M
@30
D=D|M
@19
M=D//19 = F(R3,K3)
@19
D=!M
@16
D=D&M
@30
M=D
@16
D=!M
@19
D=D&M
@30
D=D|M
@20
M=D//20 = R4
@18//LEFT SHIFT L4 AND ADD
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
D=D+M
M=D
D=M
@20
D=D+M
@0
M=D
@354
0;JMP